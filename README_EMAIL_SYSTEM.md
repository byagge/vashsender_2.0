# üöÄ –°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º VashSender

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –ø–∏—Å–µ–º (–¥–æ 10,000+ –ø–∏—Å–µ–º –∑–∞ –∫–∞–º–ø–∞–Ω–∏—é) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:

- **Celery** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á
- **Redis** - –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **SMTP Connection Pool** - –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- **Batching** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞–∫–µ—Ç–∞–º–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Rate Limiting** - –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
- **Retry Mechanism** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **Real-time Monitoring** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

1. **Django Views** - API –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–º–ø–∞–Ω–∏–π
2. **Celery Tasks** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
3. **SMTP Pool** - –ø—É–ª SMTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
4. **Redis** - –±—Ä–æ–∫–µ—Ä –∏ –∫—ç—à
5. **Flower** - –≤–µ–±-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

```
User Request ‚Üí Django View ‚Üí Celery Task ‚Üí Email Batch ‚Üí SMTP Pool ‚Üí Email Server
```

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install redis-server
sudo systemctl enable redis-server
sudo systemctl start redis-server
```

**Windows:**
```bash
# –°–∫–∞—á–∞—Ç—å Redis –¥–ª—è Windows —Å https://github.com/microsoftarchive/redis/releases
# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WSL
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Django

–î–æ–±–∞–≤—å—Ç–µ –≤ `settings.py`:

```python
# Celery Configuration
CELERY_BROKER_URL = 'redis://localhost:6379/0'
CELERY_RESULT_BACKEND = 'redis://localhost:6379/0'

# Email sending configuration
EMAIL_BATCH_SIZE = 100  # –ü–∏—Å–µ–º –≤ –±–∞—Ç—á–µ
EMAIL_RATE_LIMIT = 50   # –ü–∏—Å–µ–º –≤ —Å–µ–∫—É–Ω–¥—É
EMAIL_MAX_RETRIES = 3   # –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫
EMAIL_RETRY_DELAY = 60  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ (—Å–µ–∫)
EMAIL_CONNECTION_TIMEOUT = 30  # Timeout —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
EMAIL_SEND_TIMEOUT = 60  # Timeout –æ—Ç–ø—Ä–∞–≤–∫–∏
```

### 4. –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
python manage.py makemigrations
python manage.py migrate
```

## üöÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

### 1. –ó–∞–ø—É—Å–∫ Redis

```bash
redis-server
```

### 2. –ó–∞–ø—É—Å–∫ Celery Worker

```bash
# –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
python manage.py start_celery_worker

# –° –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
python manage.py start_celery_worker --concurrency=8 --queues=email,campaigns,default --loglevel=info
```

### 3. –ó–∞–ø—É—Å–∫ Celery Beat (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
python manage.py start_celery_beat
```

### 4. –ó–∞–ø—É—Å–∫ Flower (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

```bash
python manage.py start_flower --port=5555
```

### 5. –ó–∞–ø—É—Å–∫ Django

```bash
python manage.py runserver
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Flower Dashboard

–î–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:5555`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—è–º–∏

### API –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

```bash
GET /campaigns/api/campaigns/{id}/progress/
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "campaign_id": "uuid",
    "status": "sending",
    "progress": {
        "total": 10000,
        "sent": 3500,
        "progress": 35.0
    }
}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP

–í `settings/local.py`:

```python
EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = 'your-smtp-server.com'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
EMAIL_HOST_USER = 'your-email@domain.com'
EMAIL_HOST_PASSWORD = 'your-password'
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

```python
# –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
EMAIL_BATCH_SIZE = 200

# –£–≤–µ–ª–∏—á–∏—Ç—å rate limit
EMAIL_RATE_LIMIT = 100

# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ worker –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
# --concurrency=16

# –£–≤–µ–ª–∏—á–∏—Ç—å –ø—É–ª SMTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
# –í tasks.py: SMTPConnectionPool(max_connections=20)
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –û–±—ä–µ–º –ø–∏—Å–µ–º | –í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ | –£—Å–ø–µ—à–Ω–æ—Å—Ç—å |
|-------------|----------------|------------|
| 1,000       | ~2-3 –º–∏–Ω—É—Ç—ã    | 99.5%      |
| 5,000       | ~8-12 –º–∏–Ω—É—Ç    | 99.2%      |
| 10,000      | ~15-20 –º–∏–Ω—É—Ç   | 98.8%      |
| 50,000      | ~60-90 –º–∏–Ω—É—Ç   | 97.5%      |

### –§–∞–∫—Ç–æ—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

1. **SMTP —Å–µ—Ä–≤–µ—Ä** - –æ—Å–Ω–æ–≤–Ω–æ–π –ª–∏–º–∏—Ç–∏—Ä—É—é—â–∏–π —Ñ–∞–∫—Ç–æ—Ä
2. **–°–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** - —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
3. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ worker –ø—Ä–æ—Ü–µ—Å—Å–æ–≤** - –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º
4. **–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
5. **Rate limiting** - –∑–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Rate Limiting

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä–æ–≤

### Retry Mechanism

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏

## üîç –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ Celery

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ worker
celery -A core worker --loglevel=debug

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ beat
celery -A core beat --loglevel=debug
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis

```bash
redis-cli
> INFO
> KEYS *
> LLEN celery
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SMTP

```python
from django.core.mail import send_mail

# –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
send_mail(
    'Test Subject',
    'Test Message',
    'from@example.com',
    ['to@example.com'],
    fail_silently=False,
)
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: Redis –Ω–µ –∑–∞–ø—É—â–µ–Ω
```bash
# –†–µ—à–µ–Ω–∏–µ
sudo systemctl start redis-server
redis-cli ping  # –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å PONG
```

### –ü—Ä–æ–±–ª–µ–º–∞: Celery worker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install celery redis

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
python manage.py shell
>>> from django.conf import settings
>>> print(settings.CELERY_BROKER_URL)
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–∏—Å—å–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ SMTP –Ω–∞—Å—Ç—Ä–æ–µ–∫
python manage.py shell
>>> from django.core.mail import send_mail
>>> send_mail('Test', 'Test', 'from@example.com', ['to@example.com'])
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
```python
# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ worker –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
python manage.py start_celery_worker --concurrency=16

# –£–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
EMAIL_BATCH_SIZE = 200

# –£–≤–µ–ª–∏—á–∏—Ç—å rate limit
EMAIL_RATE_LIMIT = 100
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Celery
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Redis
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
5. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π SMTP —Å–µ—Ä–≤–µ—Ä**
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SPF, DKIM, DMARC**
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–µ–ø—É—Ç–∞—Ü–∏—é IP**
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL/TLS**
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—ç–∫–∞–ø—ã Redis**

### –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤:

1. **–£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ worker –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Redis**
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ SMTP —Å–µ—Ä–≤–µ—Ä–æ–≤**
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã**

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ 10,000+ –ø–∏—Å–µ–º —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é!** üöÄ 