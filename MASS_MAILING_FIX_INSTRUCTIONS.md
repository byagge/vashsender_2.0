# üöÄ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú –° –î–û–°–¢–ê–í–ö–û–ô –ú–ê–°–°–û–í–´–• –†–ê–°–°–´–õ–û–ö

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–∏—Å—å–º–∞ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞ —Ç—ã—Å—è—á–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤, –Ω–æ –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –º–µ–Ω—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö.

## ‚úÖ –í–ù–ï–°–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ (—Ñ–∞–π–ª `env`)
- `EMAIL_BATCH_SIZE`: 200 ‚Üí 20 (—É–º–µ–Ω—å—à–µ–Ω–æ –≤ 10 —Ä–∞–∑)
- `EMAIL_RATE_LIMIT`: 100 ‚Üí 5 (—É–º–µ–Ω—å—à–µ–Ω–æ –≤ 20 —Ä–∞–∑)
- `EMAIL_RETRY_DELAY`: 60 ‚Üí 120 —Å–µ–∫—É–Ω–¥ (—É–≤–µ–ª–∏—á–µ–Ω–æ –≤ 2 —Ä–∞–∑–∞)

### 2. –£–ª—É—á—à–µ–Ω rate limiting –≤ –∫–æ–¥–µ (`apps/campaigns/tasks.py`)
- –£–≤–µ–ª–∏—á–µ–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –ø–∏—Å—å–º–∞–º–∏: 0.15-0.25 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 0.08-0.12 —Å–µ–∫
- –£–≤–µ–ª–∏—á–µ–Ω—ã –ø–∞—É–∑—ã –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏: 2-3 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 1-2 —Å–µ–∫
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–æ–º –±–∞—Ç—á–µ–π: 3-5 —Å–µ–∫

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–µ–π
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50 ‚Üí 20 –ø–∏—Å–µ–º –≤ –±–∞—Ç—á–µ
- –õ—É—á—à–∞—è –¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç—å –ø—Ä–∏ –º–µ–Ω—å—à–∏—Ö –±–∞—Ç—á–∞—Ö

## üîß –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
–§–∞–π–ª `env` —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Celery workers
sudo systemctl restart celery

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Django
sudo systemctl restart gunicorn

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status celery
sudo systemctl status gunicorn
```

### –®–∞–≥ 3: –í—ã–±—Ä–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π SMTP (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)
–õ–æ–∫–∞–ª—å–Ω—ã–π SMTP —Å–µ—Ä–≤–µ—Ä - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π.

#### –í–∞—Ä–∏–∞–Ω—Ç A: Yandex SMTP (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –†–æ—Å—Å–∏–∏)
1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç Yandex
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. –í–∫–ª—é—á–∏—Ç–µ "–ü–∞—Ä–æ–ª–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
4. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
5. –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª `env`:
```bash
EMAIL_HOST=smtp.yandex.ru
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@yandex.ru
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=your-email@yandex.ru
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: Gmail SMTP
1. –í–∫–ª—é—á–∏—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª `env`:
```bash
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=your-email@gmail.com
```

## üìä –°–¢–†–ê–¢–ï–ì–ò–Ø –î–õ–Ø –ë–û–õ–¨–®–ò–• –†–ê–°–°–´–õ–û–ö

### –î–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫ 1000+ –ø–∏—Å–µ–º:
1. **–†–∞–∑–¥–µ–ª–∏—Ç–µ –Ω–∞ —á–∞—Å—Ç–∏**: 1000-2000 –ø–∏—Å–µ–º –≤ –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏
2. **–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã**: 2-4 —á–∞—Å–∞ –º–µ–∂–¥—É —á–∞—Å—Ç—è–º–∏
3. **–í—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏**: –Ω–æ—á—å –∏–ª–∏ –≤—ã—Ö–æ–¥–Ω—ã–µ
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –î–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫ 5000+ –ø–∏—Å–µ–º:
1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–Ω–µ—à–Ω–∏–π SMTP**: Yandex, Gmail –∏–ª–∏ SendGrid
2. **–†–∞–∑–¥–µ–ª–∏—Ç–µ –Ω–∞ 3-5 —á–∞—Å—Ç–µ–π**
3. **–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã**: 4-6 —á–∞—Å–æ–≤ –º–µ–∂–¥—É —á–∞—Å—Ç—è–º–∏
4. **–ö–∞—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∫–æ–≤**: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å email –∞–¥—Ä–µ—Å–æ–≤

## üõ†Ô∏è –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢–´

### –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ–±—ä–µ–º–∞ (`gradual_volume_increase.py`)
```bash
python gradual_volume_increase.py
```
–ü–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ª—é–±–æ–≥–æ –æ–±—ä–µ–º–∞.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ SMTP (`external_smtp_config.txt`)
–°–æ–¥–µ—Ä–∂–∏—Ç –≥–æ—Ç–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö SMTP –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.

## üìà –ú–û–ù–ò–¢–û–†–ò–ù–ì –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Django
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ö–∞–º–ø–∞–Ω–∏–∏"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –æ—Ç–ø—Ä–∞–≤–∫–∏
4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö/–Ω–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º

### –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –î–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç—å: 60-70% ‚Üí 85-95%
- –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏: –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ
- –ü–æ–ø–∞–¥–∞–Ω–∏–µ –≤ —Å–ø–∞–º: –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∑–∏—Ç—Å—è

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **–ù–µ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞—Ç–Ω–æ** - —ç—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω–∏–π SMTP** - –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç—å—é
4. **–ö–∞—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∫–æ–≤** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å email –∞–¥—Ä–µ—Å–æ–≤

## üÜò –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–´ –û–°–¢–ê–Æ–¢–°–Ø

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS –∑–∞–ø–∏—Å–∏ (SPF, DKIM, DMARC)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–Ω–µ—à–Ω–∏–π SMTP
3. –ï—â–µ –±–æ–ª—å—à–µ —É–º–µ–Ω—å—à–∏—Ç–µ `EMAIL_RATE_LIMIT` –¥–æ 2-3
4. –£–≤–µ–ª–∏—á—å—Ç–µ `EMAIL_RETRY_DELAY` –¥–æ 300 —Å–µ–∫—É–Ω–¥
5. –†–∞–∑–¥–µ–ª–∏—Ç–µ –±–æ–ª—å—à–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏ –Ω–∞ –±–æ–ª–µ–µ –º–µ–ª–∫–∏–µ —á–∞—Å—Ç–∏

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Celery: `sudo journalctl -u celery -f`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Django: `sudo journalctl -u gunicorn -f`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: `python fix_mass_mailing_delivery.py` 